/*
	Connection test
*/

var timer = setTimeout(function () {
	error("timeout - the test has taken too long");
	process.exit(-2);
}, 30000);

TestClient.on('message', function (msg) {
	console.log("recv ".grey + msg);
});

TestClient.on('send', function (msg) {
	console.log("send ".grey + msg);
});

TestClient.on('connect', function (con) {
	ok("connected to server");
});

TestClient.on('connect', function (con) {
	ok("connected to server");
});

TestClient.on('challstr', function (challstr) {
	ok("received challstr");
	ok("connection test passed");
	clearTimeout(timer);
	runNextTest();
});

testing("connection test");
TestClient.connect();